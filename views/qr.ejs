<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <title>QR ì—…ë¡œë“œ</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        background-color: whitesmoke;
        font-family: 'Noto Sans KR', sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      .container {
        background-color: #93c3e77e; /* ë°˜íˆ¬ëª… í°ìƒ‰ */
        border-radius: 10px;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        padding: 30px;
        width: 700px;
        height: 400px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .section {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .divider {
        width: 2px;
        background-color: white;
        margin: 0 20px;
      }

      img {
        width: 200px;
        height: 200px;
        object-fit: contain;
        margin-bottom: 10px;
      }

      h2 {
        margin-bottom: 10px;
        color: #333;
      }

      #file-list {
        margin-top: 10px;
        font-size: 14px;
        color: #222;
        text-align: center;
      }
      .footer-signature {
  margin-top: 20px;
  text-align: right;
  font-size: 12px;
  color: #444;
  font-family: 'Noto Sans KR', sans-serif;
  opacity: 0.7;
}
.footer-signature a {
  color: inherit;
  text-decoration: none;
}
.footer-signature a:hover {
  text-decoration: underline;
}
.page-wrapper {
  position: relative;
  width: 100%;
  height: 100vh;
  background-color: #b9e0fd;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.logo-placeholder {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 20px;
  font-weight: bold;
  color: #333;
  font-family: 'Noto Sans KR', sans-serif;
  opacity: 0.8;
}

    </style>
  </head>
  <body>
    <div class="page-wrapper">
    <div class="logo-placeholder">
      ì„¼ë””ì¹˜
    </div>    
    <div class="container">
      <div class="section">
        <h2>QRë¡œ íŒŒì¼ ì—…ë¡œë“œ</h2>
        <img src="<%= qr %>" alt="QR Code" />
        <p>íœ´ëŒ€í°ìœ¼ë¡œ QRì„ ìŠ¤ìº”í•´ë³´ì„¸ìš”!</p>
      </div>
      <div class="divider"></div>
      <div class="section" id="file-section">
        <h2>ì—…ë¡œë“œëœ íŒŒì¼</h2>
        <div id="file-list">ì•„ì§ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>
      </div>
    </div>
    <div class="footer-signature">
      ğŸ‘©â€ğŸ’» by <a href="https://github.com/joeyycho" target="_blank" rel="noopener noreferrer"><strong>joeyycho</strong></a>
    </div>    
  </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      const sessionId = "<%= sessionId %>";
      const fileList = document.getElementById("file-list");
    
      socket.emit("join-session", sessionId);
    
      socket.on("file-uploaded", (file) => {
        // "ì•„ì§ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤." ë¬¸êµ¬ ì œê±°
        if (fileList.textContent.includes("ì•„ì§ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.")) {
          fileList.innerHTML = "";
        }
    
        const link = document.createElement("a");
        link.href = `/uploads/${file.filename}`;
        link.textContent = file.originalname;
        link.download = file.originalname;
        link.style.display = "block";
    
        // ì•ˆë‚´ ë¬¸êµ¬ê°€ ì´ë¯¸ ìˆë‹¤ë©´ ì ì‹œ ì œê±°
        const note = document.getElementById("download-note");
        if (note) {
          fileList.removeChild(note);
        }
    
        // íŒŒì¼ ë§í¬ ì¶”ê°€
        fileList.appendChild(link);
    
        // ë§ˆì§€ë§‰ ì¤„ì— ì•ˆë‚´ ë¬¸êµ¬ ë‹¤ì‹œ ì¶”ê°€
        if (!document.getElementById("download-note")) {
          const newNote = document.createElement("p");
          newNote.id = "download-note";
          newNote.textContent = "â¬†ï¸ í´ë¦­í•˜ì—¬ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.";
          newNote.style.marginTop = "10px";
          newNote.style.fontSize = "14px";
          newNote.style.color = "#333";
          fileList.appendChild(newNote);
        }
      });
    </script>    
    
  </body>
</html>
